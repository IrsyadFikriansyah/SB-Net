Processing dataset: ../[2] New/dataset/train-train.csv
--- Stage 1 with Decision Tree (Gini) ---
Training Time: 116.18426 seconds
Tree Depth: 33
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9979    0.9987    0.9983    293326

    accuracy                         0.9998   6441631
   macro avg     0.9989    0.9993    0.9991   6441631
weighted avg     0.9998    0.9998    0.9998   6441631

Confusion Matrix:
[[6147702     603]
 [    388  292938]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.81970 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     1.0000    0.9999    0.9999    263629
           1     0.9990    0.9997    0.9994     29912

    accuracy                         0.9999    293541
   macro avg     0.9995    0.9998    0.9996    293541
weighted avg     0.9999    0.9999    0.9999    293541

Confusion Matrix:
[[263599     30]
 [     8  29904]]

Combined Classification Report:
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9978    0.9986    0.9982    263382
           2     0.9990    0.9987    0.9988     29944

    accuracy                         0.9998   6441631
   macro avg     0.9989    0.9991    0.9990   6441631
weighted avg     0.9998    0.9998    0.9998   6441631

Confusion Matrix:
[[6147702     579      24]
 [    356  263020       6]
 [     32       8   29904]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 30.78183 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     1.0000    0.9999    0.9999    263629
           1     0.9991    0.9999    0.9995     29912

    accuracy                         0.9999    293541
   macro avg     0.9995    0.9999    0.9997    293541
weighted avg     0.9999    0.9999    0.9999    293541

Confusion Matrix:
[[263601     28]
 [     3  29909]]

Combined Classification Report:
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9978    0.9986    0.9982    263382
           2     0.9991    0.9988    0.9989     29944

    accuracy                         0.9998   6441631
   macro avg     0.9989    0.9991    0.9990   6441631
weighted avg     0.9998    0.9998    0.9998   6441631

Confusion Matrix:
[[6147702     578      25]
 [    356  263023       3]
 [     32       3   29909]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.14629 seconds
Accuracy: 0.3420
Precision: 0.9058
Recall: 0.3420
F1 Score: 0.4041
F2 Score: 0.3268

              precision    recall  f1-score   support

           0     0.9936    0.2691    0.4235    263629
           1     0.1326    0.9846    0.2337     29912

    accuracy                         0.3420    293541
   macro avg     0.5631    0.6269    0.3286    293541
weighted avg     0.9058    0.3420    0.4041    293541

Confusion Matrix:
[[ 70939 192690]
 [   460  29452]]

Combined Classification Report:
Accuracy: 0.9699
Precision: 0.9956
Recall: 0.9699
F1 Score: 0.9728
F2 Score: 0.9693

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9925    0.2691    0.4234    263382
           2     0.1326    0.9836    0.2337     29944

    accuracy                         0.9699   6441631
   macro avg     0.7084    0.7508    0.5523   6441631
weighted avg     0.9956    0.9699    0.9728   6441631

Confusion Matrix:
[[6147702      72     531]
 [    356   70867  192159]
 [     32     460   29452]]

------ Stage 2 with KNN (k=5) ------
Training Time: 1.97829 seconds
Accuracy: 0.9994
Precision: 0.9994
Recall: 0.9994
F1 Score: 0.9994
F2 Score: 0.9994

              precision    recall  f1-score   support

           0     0.9998    0.9995    0.9997    263629
           1     0.9960    0.9983    0.9971     29912

    accuracy                         0.9994    293541
   macro avg     0.9979    0.9989    0.9984    293541
weighted avg     0.9994    0.9994    0.9994    293541

Confusion Matrix:
[[263509    120]
 [    51  29861]]

Combined Classification Report:
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9978    0.9984    0.9981    263382
           2     0.9960    0.9972    0.9966     29944

    accuracy                         0.9998   6441631
   macro avg     0.9979    0.9985    0.9982   6441631
weighted avg     0.9998    0.9998    0.9998   6441631

Confusion Matrix:
[[6147702     540      63]
 [    356  262969      57]
 [     32      51   29861]]

------ Stage 2 with Gradient Boosting ------
Training Time: 69.75049 seconds
Accuracy: 0.9969
Precision: 0.9969
Recall: 0.9969
F1 Score: 0.9969
F2 Score: 0.9969

              precision    recall  f1-score   support

           0     0.9978    0.9987    0.9983    263629
           1     0.9883    0.9810    0.9846     29912

    accuracy                         0.9969    293541
   macro avg     0.9931    0.9898    0.9915    293541
weighted avg     0.9969    0.9969    0.9969    293541

Confusion Matrix:
[[263283    346]
 [   569  29343]]

Combined Classification Report:
Accuracy: 0.9997
Precision: 0.9997
Recall: 0.9997
F1 Score: 0.9997
F2 Score: 0.9997

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9957    0.9974    0.9966    263382
           2     0.9883    0.9799    0.9841     29944

    accuracy                         0.9997   6441631
   macro avg     0.9946    0.9924    0.9935   6441631
weighted avg     0.9997    0.9997    0.9997   6441631

Confusion Matrix:
[[6147702     575      28]
 [    356  262708     318]
 [     32     569   29343]]

------ Stage 2 with Logistic Regression ------
Training Time: 2.98180 seconds
Accuracy: 0.9272
Precision: 0.9230
Recall: 0.9272
F1 Score: 0.9246
F2 Score: 0.9261

              precision    recall  f1-score   support

           0     0.9520    0.9677    0.9598    263629
           1     0.6669    0.5701    0.6147     29912

    accuracy                         0.9272    293541
   macro avg     0.8094    0.7689    0.7873    293541
weighted avg     0.9230    0.9272    0.9246    293541

Confusion Matrix:
[[255110   8519]
 [ 12858  17054]]

Combined Classification Report:
Accuracy: 0.9965
Precision: 0.9963
Recall: 0.9965
F1 Score: 0.9964
F2 Score: 0.9965

              precision    recall  f1-score   support

           0     0.9999    0.9999    0.9999   6148305
           1     0.9501    0.9666    0.9583    263382
           2     0.6669    0.5695    0.6144     29944

    accuracy                         0.9965   6441631
   macro avg     0.8723    0.8453    0.8575   6441631
weighted avg     0.9963    0.9965    0.9964   6441631

Confusion Matrix:
[[6147702     524      79]
 [    356  254586    8440]
 [     32   12858   17054]]

--- Stage 1 with Random Forest (Gini) ---
Training Time: 1905.38074 seconds
Random Forest Depths -> Avg: 40.07, Max: 46, Min: 35
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9998    0.9984    0.9991    293326

    accuracy                         0.9999   6441631
   macro avg     0.9999    0.9992    0.9995   6441631
weighted avg     0.9999    0.9999    0.9999   6441631

Confusion Matrix:
[[6148253      52]
 [    481  292845]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.75780 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     1.0000    0.9999    1.0000    262972
           1     0.9995    0.9997    0.9996     29925

    accuracy                         0.9999    292897
   macro avg     0.9997    0.9998    0.9998    292897
weighted avg     0.9999    0.9999    0.9999    292897

Confusion Matrix:
[[262956     16]
 [     9  29916]]

Combined Classification Report:
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9998    0.9982    0.9990    263382
           2     0.9995    0.9991    0.9993     29944

    accuracy                         0.9999   6441631
   macro avg     0.9997    0.9991    0.9994   6441631
weighted avg     0.9999    0.9999    0.9999   6441631

Confusion Matrix:
[[6148253      42      10]
 [    462  262914       6]
 [     19       9   29916]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 29.85760 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     1.0000    0.9999    1.0000    262972
           1     0.9995    0.9999    0.9997     29925

    accuracy                         0.9999    292897
   macro avg     0.9998    0.9999    0.9999    292897
weighted avg     0.9999    0.9999    0.9999    292897

Confusion Matrix:
[[262958     14]
 [     2  29923]]

Combined Classification Report:
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9998    0.9982    0.9990    263382
           2     0.9995    0.9993    0.9994     29944

    accuracy                         0.9999   6441631
   macro avg     0.9998    0.9992    0.9995   6441631
weighted avg     0.9999    0.9999    0.9999   6441631

Confusion Matrix:
[[6148253      41      11]
 [    462  262917       3]
 [     19       2   29923]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.14421 seconds
Accuracy: 0.3423
Precision: 0.9057
Recall: 0.3423
F1 Score: 0.4043
F2 Score: 0.3271

              precision    recall  f1-score   support

           0     0.9936    0.2692    0.4237    262972
           1     0.1330    0.9847    0.2343     29925

    accuracy                         0.3423    292897
   macro avg     0.5633    0.6270    0.3290    292897
weighted avg     0.9057    0.3423    0.4043    292897

Confusion Matrix:
[[ 70803 192169]
 [   457  29468]]

Combined Classification Report:
Accuracy: 0.9700
Precision: 0.9956
Recall: 0.9700
F1 Score: 0.9728
F2 Score: 0.9693

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9935    0.2688    0.4231    263382
           2     0.1330    0.9841    0.2343     29944

    accuracy                         0.9700   6441631
   macro avg     0.7088    0.7510    0.5525   6441631
weighted avg     0.9956    0.9700    0.9728   6441631

Confusion Matrix:
[[6148253       3      49]
 [    462   70800  192120]
 [     19     457   29468]]

------ Stage 2 with KNN (k=5) ------
Training Time: 1.96799 seconds
Accuracy: 0.9996
Precision: 0.9996
Recall: 0.9996
F1 Score: 0.9996
F2 Score: 0.9996

              precision    recall  f1-score   support

           0     0.9998    0.9997    0.9998    262972
           1     0.9977    0.9986    0.9981     29925

    accuracy                         0.9996    292897
   macro avg     0.9988    0.9992    0.9990    292897
weighted avg     0.9996    0.9996    0.9996    292897

Confusion Matrix:
[[262903     69]
 [    43  29882]]

Combined Classification Report:
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9997    0.9980    0.9989    263382
           2     0.9977    0.9979    0.9978     29944

    accuracy                         0.9999   6441631
   macro avg     0.9991    0.9987    0.9989   6441631
weighted avg     0.9999    0.9999    0.9999   6441631

Confusion Matrix:
[[6148253      39      13]
 [    462  262864      56]
 [     19      43   29882]]

------ Stage 2 with Gradient Boosting ------
Training Time: 69.44947 seconds
Accuracy: 0.9969
Precision: 0.9969
Recall: 0.9969
F1 Score: 0.9969
F2 Score: 0.9969

              precision    recall  f1-score   support

           0     0.9979    0.9987    0.9983    262972
           1     0.9888    0.9812    0.9850     29925

    accuracy                         0.9969    292897
   macro avg     0.9933    0.9900    0.9917    292897
weighted avg     0.9969    0.9969    0.9969    292897

Confusion Matrix:
[[262640    332]
 [   562  29363]]

Combined Classification Report:
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9977    0.9970    0.9974    263382
           2     0.9888    0.9806    0.9847     29944

    accuracy                         0.9998   6441631
   macro avg     0.9955    0.9925    0.9940   6441631
weighted avg     0.9998    0.9998    0.9998   6441631

Confusion Matrix:
[[6148253      39      13]
 [    462  262601     319]
 [     19     562   29363]]

------ Stage 2 with Logistic Regression ------
Training Time: 2.99564 seconds
Accuracy: 0.9272
Precision: 0.9229
Recall: 0.9272
F1 Score: 0.9246
F2 Score: 0.9261

              precision    recall  f1-score   support

           0     0.9519    0.9678    0.9598    262972
           1     0.6686    0.5701    0.6154     29925

    accuracy                         0.9272    292897
   macro avg     0.8102    0.7690    0.7876    292897
weighted avg     0.9229    0.9272    0.9246    292897

Confusion Matrix:
[[254514   8458]
 [ 12864  17061]]

Combined Classification Report:
Accuracy: 0.9966
Precision: 0.9964
Recall: 0.9966
F1 Score: 0.9965
F2 Score: 0.9966

              precision    recall  f1-score   support

           0     0.9999    1.0000    1.0000   6148305
           1     0.9517    0.9662    0.9589    263382
           2     0.6686    0.5698    0.6152     29944

    accuracy                         0.9966   6441631
   macro avg     0.8734    0.8453    0.8580   6441631
weighted avg     0.9964    0.9966    0.9965   6441631

Confusion Matrix:
[[6148253      41      11]
 [    462  254473    8447]
 [     19   12864   17061]]

--- Stage 1 with Naive Bayes ---
Training Time: 3.20446 seconds
Accuracy: 0.9400
Precision: 0.9259
Recall: 0.9400
F1 Score: 0.9323
F2 Score: 0.9368

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2248    0.1297    0.1645    293326

    accuracy                         0.9400   6441631
   macro avg     0.5920    0.5542    0.5667   6441631
weighted avg     0.9259    0.9400    0.9323   6441631

Confusion Matrix:
[[6017065  131240]
 [ 255278   38048]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.78356 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9853
Precision: 0.9906
Recall: 0.9853
F1 Score: 0.9868
F2 Score: 0.9855

              precision    recall  f1-score   support

           0     1.0000    0.9849    0.9924    164844
           1     0.6408    1.0000    0.7811      4444

    accuracy                         0.9853    169288
   macro avg     0.8204    0.9924    0.8867    169288
weighted avg     0.9906    0.9853    0.9868    169288

Confusion Matrix:
[[162353   2491]
 [     0   4444]]

Combined Classification Report:
Accuracy: 0.9400
Precision: 0.9271
Recall: 0.9400
F1 Score: 0.9323
F2 Score: 0.9368

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2070    0.1276    0.1579    263382
           2     0.6408    0.1484    0.2410     29944

    accuracy                         0.9400   6441631
   macro avg     0.6024    0.4182    0.4559   6441631
weighted avg     0.9271    0.9400    0.9323   6441631

Confusion Matrix:
[[6017065  128749    2491]
 [ 229778   33604       0]
 [  25500       0    4444]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 30.17026 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9980
Precision: 0.9982
Recall: 0.9980
F1 Score: 0.9981
F2 Score: 0.9980

              precision    recall  f1-score   support

           0     1.0000    0.9980    0.9990    164844
           1     0.9297    1.0000    0.9636      4444

    accuracy                         0.9980    169288
   macro avg     0.9649    0.9990    0.9813    169288
weighted avg     0.9982    0.9980    0.9981    169288

Confusion Matrix:
[[164508    336]
 [     0   4444]]

Combined Classification Report:
Accuracy: 0.9400
Precision: 0.9283
Recall: 0.9400
F1 Score: 0.9324
F2 Score: 0.9368

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2043    0.1276    0.1571    263382
           2     0.9297    0.1484    0.2560     29944

    accuracy                         0.9400   6441631
   macro avg     0.6978    0.4182    0.4606   6441631
weighted avg     0.9283    0.9400    0.9324   6441631

Confusion Matrix:
[[6017065  130904     336]
 [ 229778   33604       0]
 [  25500       0    4444]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.14744 seconds
Accuracy: 0.3242
Precision: 0.9736
Recall: 0.3242
F1 Score: 0.4585
F2 Score: 0.3506

              precision    recall  f1-score   support

           0     0.9989    0.3064    0.4689    164844
           1     0.0370    0.9874    0.0712      4444

    accuracy                         0.3242    169288
   macro avg     0.5179    0.6469    0.2701    169288
weighted avg     0.9736    0.3242    0.4585    169288

Confusion Matrix:
[[ 50500 114344]
 [    56   4388]]

Combined Classification Report:
Accuracy: 0.9368
Precision: 0.9263
Recall: 0.9368
F1 Score: 0.9284
F2 Score: 0.9332

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2581    0.0495    0.0831    263382
           2     0.0370    0.1465    0.0590     29944

    accuracy                         0.9368   6441631
   macro avg     0.4181    0.3916    0.3703   6441631
weighted avg     0.9263    0.9368    0.9284   6441631

Confusion Matrix:
[[6017065   37452   93788]
 [ 229778   13048   20556]
 [  25500      56    4388]]

------ Stage 2 with KNN (k=5) ------
Training Time: 1.95405 seconds
Accuracy: 0.8747
Precision: 0.9783
Recall: 0.8747
F1 Score: 0.9146
F2 Score: 0.8843

              precision    recall  f1-score   support

           0     1.0000    0.8714    0.9313    164844
           1     0.1732    0.9998    0.2953      4444

    accuracy                         0.8747    169288
   macro avg     0.5866    0.9356    0.6133    169288
weighted avg     0.9783    0.8747    0.9146    169288

Confusion Matrix:
[[143641  21203]
 [     1   4443]]

Combined Classification Report:
Accuracy: 0.9400
Precision: 0.9260
Recall: 0.9400
F1 Score: 0.9323
F2 Score: 0.9368

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2339    0.1276    0.1651    263382
           2     0.1732    0.1484    0.1598     29944

    accuracy                         0.9400   6441631
   macro avg     0.4555    0.4182    0.4313   6441631
weighted avg     0.9260    0.9400    0.9323   6441631

Confusion Matrix:
[[6017065  110043   21197]
 [ 229778   33598       6]
 [  25500       1    4443]]

------ Stage 2 with Gradient Boosting ------
Training Time: 69.66773 seconds
Accuracy: 0.9785
Precision: 0.9876
Recall: 0.9785
F1 Score: 0.9814
F2 Score: 0.9790

              precision    recall  f1-score   support

           0     0.9994    0.9785    0.9888    164844
           1     0.5508    0.9784    0.7048      4444

    accuracy                         0.9785    169288
   macro avg     0.7751    0.9784    0.8468    169288
weighted avg     0.9876    0.9785    0.9814    169288

Confusion Matrix:
[[161298   3546]
 [    96   4348]]

Combined Classification Report:
Accuracy: 0.9400
Precision: 0.9267
Recall: 0.9400
F1 Score: 0.9323
F2 Score: 0.9368

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2082    0.1276    0.1582    263382
           2     0.5508    0.1452    0.2298     29944

    accuracy                         0.9400   6441631
   macro avg     0.5728    0.4171    0.4523   6441631
weighted avg     0.9267    0.9400    0.9323   6441631

Confusion Matrix:
[[6017065  127694    3546]
 [ 229778   33604       0]
 [  25500      96    4348]]

------ Stage 2 with Logistic Regression ------
Training Time: 2.94796 seconds
Accuracy: 0.7918
Precision: 0.9604
Recall: 0.7918
F1 Score: 0.8619
F2 Score: 0.8141

              precision    recall  f1-score   support

           0     0.9845    0.7987    0.8819    164844
           1     0.0667    0.5333    0.1185      4444

    accuracy                         0.7918    169288
   macro avg     0.5256    0.6660    0.5002    169288
weighted avg     0.9604    0.7918    0.8619    169288

Confusion Matrix:
[[131669  33175]
 [  2074   2370]]

Combined Classification Report:
Accuracy: 0.9395
Precision: 0.9259
Recall: 0.9395
F1 Score: 0.9318
F2 Score: 0.9363

              precision    recall  f1-score   support

           0     0.9593    0.9787    0.9689   6148305
           1     0.2434    0.1236    0.1640    263382
           2     0.0667    0.0791    0.0724     29944

    accuracy                         0.9395   6441631
   macro avg     0.4231    0.3938    0.4017   6441631
weighted avg     0.9259    0.9395    0.9318   6441631

Confusion Matrix:
[[6017065   99110   32130]
 [ 229778   32559    1045]
 [  25500    2074    2370]]

--- Stage 1 with KNN (k=5) ---
Training Time: 76.05623 seconds
Accuracy: 0.9959
Precision: 0.9959
Recall: 0.9959
F1 Score: 0.9959
F2 Score: 0.9959

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9487    0.9610    0.9548    293326

    accuracy                         0.9959   6441631
   macro avg     0.9734    0.9793    0.9763   6441631
weighted avg     0.9959    0.9959    0.9959   6441631

Confusion Matrix:
[[6133048   15257]
 [  11444  281882]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.81694 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9993
Precision: 0.9993
Recall: 0.9993
F1 Score: 0.9993
F2 Score: 0.9993

              precision    recall  f1-score   support

           0     1.0000    0.9992    0.9996    268160
           1     0.9929    0.9998    0.9964     28979

    accuracy                         0.9993    297139
   macro avg     0.9965    0.9995    0.9980    297139
weighted avg     0.9993    0.9993    0.9993    297139

Confusion Matrix:
[[267954    206]
 [     6  28973]]

Combined Classification Report:
Accuracy: 0.9959
Precision: 0.9959
Recall: 0.9959
F1 Score: 0.9959
F2 Score: 0.9959

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9438    0.9602    0.9519    263382
           2     0.9929    0.9676    0.9801     29944

    accuracy                         0.9959   6441631
   macro avg     0.9783    0.9751    0.9766   6441631
weighted avg     0.9959    0.9959    0.9959   6441631

Confusion Matrix:
[[6133048   15054     203]
 [  10479  252900       3]
 [    965       6   28973]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 30.26414 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9998
Precision: 0.9998
Recall: 0.9998
F1 Score: 0.9998
F2 Score: 0.9998

              precision    recall  f1-score   support

           0     1.0000    0.9998    0.9999    268160
           1     0.9981    1.0000    0.9991     28979

    accuracy                         0.9998    297139
   macro avg     0.9991    0.9999    0.9995    297139
weighted avg     0.9998    0.9998    0.9998    297139

Confusion Matrix:
[[268105     55]
 [     0  28979]]

Combined Classification Report:
Accuracy: 0.9959
Precision: 0.9959
Recall: 0.9959
F1 Score: 0.9959
F2 Score: 0.9959

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9433    0.9602    0.9517    263382
           2     0.9981    0.9678    0.9827     29944

    accuracy                         0.9959   6441631
   macro avg     0.9798    0.9752    0.9774   6441631
weighted avg     0.9959    0.9959    0.9959   6441631

Confusion Matrix:
[[6133048   15203      54]
 [  10479  252902       1]
 [    965       0   28979]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.13842 seconds
Accuracy: 0.3387
Precision: 0.9091
Recall: 0.3387
F1 Score: 0.4040
F2 Score: 0.3250

              precision    recall  f1-score   support

           0     0.9937    0.2689    0.4233    268160
           1     0.1270    0.9841    0.2250     28979

    accuracy                         0.3387    297139
   macro avg     0.5603    0.6265    0.3241    297139
weighted avg     0.9091    0.3387    0.4040    297139

Confusion Matrix:
[[ 72121 196039]
 [   460  28519]]

Combined Classification Report:
Accuracy: 0.9673
Precision: 0.9926
Recall: 0.9673
F1 Score: 0.9704
F2 Score: 0.9668

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9606    0.2647    0.4151    263382
           2     0.1270    0.9524    0.2241     29944

    accuracy                         0.9673   6441631
   macro avg     0.6952    0.7382    0.5457   6441631
weighted avg     0.9926    0.9673    0.9704   6441631

Confusion Matrix:
[[6133048    2399   12858]
 [  10479   69722  183181]
 [    965     460   28519]]

------ Stage 2 with KNN (k=5) ------
Training Time: 2.02534 seconds
Accuracy: 0.9938
Precision: 0.9941
Recall: 0.9938
F1 Score: 0.9938
F2 Score: 0.9938

              precision    recall  f1-score   support

           0     0.9999    0.9931    0.9965    268160
           1     0.9403    0.9993    0.9689     28979

    accuracy                         0.9938    297139
   macro avg     0.9701    0.9962    0.9827    297139
weighted avg     0.9941    0.9938    0.9938    297139

Confusion Matrix:
[[266323   1837]
 [    20  28959]]

Combined Classification Report:
Accuracy: 0.9958
Precision: 0.9959
Recall: 0.9958
F1 Score: 0.9959
F2 Score: 0.9959

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9495    0.9602    0.9548    263382
           2     0.9403    0.9671    0.9535     29944

    accuracy                         0.9958   6441631
   macro avg     0.9627    0.9749    0.9687   6441631
weighted avg     0.9959    0.9958    0.9959   6441631

Confusion Matrix:
[[6133048   13434    1823]
 [  10479  252889      14]
 [    965      20   28959]]

------ Stage 2 with Gradient Boosting ------
Training Time: 69.89525 seconds
Accuracy: 0.9971
Precision: 0.9971
Recall: 0.9971
F1 Score: 0.9971
F2 Score: 0.9971

              precision    recall  f1-score   support

           0     0.9980    0.9988    0.9984    268160
           1     0.9889    0.9813    0.9851     28979

    accuracy                         0.9971    297139
   macro avg     0.9935    0.9901    0.9918    297139
weighted avg     0.9971    0.9971    0.9971    297139

Confusion Matrix:
[[267842    318]
 [   542  28437]]

Combined Classification Report:
Accuracy: 0.9957
Precision: 0.9958
Recall: 0.9957
F1 Score: 0.9957
F2 Score: 0.9957

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9413    0.9592    0.9502    263382
           2     0.9889    0.9497    0.9689     29944

    accuracy                         0.9957   6441631
   macro avg     0.9761    0.9688    0.9723   6441631
weighted avg     0.9958    0.9957    0.9957   6441631

Confusion Matrix:
[[6133048   15205      52]
 [  10479  252637     266]
 [    965     542   28437]]

------ Stage 2 with Logistic Regression ------
Training Time: 3.21317 seconds
Accuracy: 0.9278
Precision: 0.9243
Recall: 0.9278
F1 Score: 0.9258
F2 Score: 0.9269

              precision    recall  f1-score   support

           0     0.9543    0.9663    0.9602    268160
           1     0.6468    0.5715    0.6068     28979

    accuracy                         0.9278    297139
   macro avg     0.8005    0.7689    0.7835    297139
weighted avg     0.9243    0.9278    0.9258    297139

Confusion Matrix:
[[259116   9044]
 [ 12417  16562]]

Combined Classification Report:
Accuracy: 0.9927
Precision: 0.9925
Recall: 0.9927
F1 Score: 0.9926
F2 Score: 0.9926

              precision    recall  f1-score   support

           0     0.9981    0.9975    0.9978   6148305
           1     0.9014    0.9293    0.9151    263382
           2     0.6468    0.5531    0.5963     29944

    accuracy                         0.9927   6441631
   macro avg     0.8488    0.8266    0.8364   6441631
weighted avg     0.9925    0.9927    0.9926   6441631

Confusion Matrix:
[[6133048   14354     903]
 [  10479  244762    8141]
 [    965   12417   16562]]

--- Stage 1 with Gradient Boosting ---
Training Time: 2777.48179 seconds
Accuracy: 0.9901
Precision: 0.9901
Recall: 0.9901
F1 Score: 0.9897
F2 Score: 0.9899

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9808    0.7991    0.8807    293326

    accuracy                         0.9901   6441631
   macro avg     0.9857    0.8992    0.9378   6441631
weighted avg     0.9901    0.9901    0.9897   6441631

Confusion Matrix:
[[6143726    4579]
 [  58915  234411]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.83172 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9995
Precision: 0.9995
Recall: 0.9995
F1 Score: 0.9995
F2 Score: 0.9995

              precision    recall  f1-score   support

           0     1.0000    0.9995    0.9997    213678
           1     0.9954    0.9996    0.9975     25312

    accuracy                         0.9995    238990
   macro avg     0.9977    0.9996    0.9986    238990
weighted avg     0.9995    0.9995    0.9995    238990

Confusion Matrix:
[[213562    116]
 [     9  25303]]

Combined Classification Report:
Accuracy: 0.9901
Precision: 0.9901
Recall: 0.9901
F1 Score: 0.9897
F2 Score: 0.9899

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9790    0.7939    0.8768    263382
           2     0.9954    0.8450    0.9141     29944

    accuracy                         0.9901   6441631
   macro avg     0.9883    0.8794    0.9286   6441631
weighted avg     0.9901    0.9901    0.9897   6441631

Confusion Matrix:
[[6143726    4466     113]
 [  54283  209096       3]
 [   4632       9   25303]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 29.96604 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9996
Precision: 0.9996
Recall: 0.9996
F1 Score: 0.9996
F2 Score: 0.9996

              precision    recall  f1-score   support

           0     1.0000    0.9995    0.9997    213678
           1     0.9959    0.9999    0.9979     25312

    accuracy                         0.9996    238990
   macro avg     0.9979    0.9997    0.9988    238990
weighted avg     0.9996    0.9996    0.9996    238990

Confusion Matrix:
[[213573    105]
 [     2  25310]]

Combined Classification Report:
Accuracy: 0.9901
Precision: 0.9901
Recall: 0.9901
F1 Score: 0.9897
F2 Score: 0.9899

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9790    0.7939    0.8768    263382
           2     0.9959    0.8452    0.9144     29944

    accuracy                         0.9901   6441631
   macro avg     0.9885    0.8795    0.9287   6441631
weighted avg     0.9901    0.9901    0.9897   6441631

Confusion Matrix:
[[6143726    4477     102]
 [  54283  209096       3]
 [   4632       2   25310]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.15545 seconds
Accuracy: 0.3713
Precision: 0.9066
Recall: 0.3713
F1 Score: 0.4365
F2 Score: 0.3578

              precision    recall  f1-score   support

           0     0.9970    0.2978    0.4586    213678
           1     0.1434    0.9924    0.2506     25312

    accuracy                         0.3713    238990
   macro avg     0.5702    0.6451    0.3546    238990
weighted avg     0.9066    0.3713    0.4365    238990

Confusion Matrix:
[[ 63624 150054]
 [   192  25120]]

Combined Classification Report:
Accuracy: 0.9674
Precision: 0.9863
Recall: 0.9674
F1 Score: 0.9664
F2 Score: 0.9655

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9844    0.2385    0.3840    263382
           2     0.1434    0.8389    0.2449     29944

    accuracy                         0.9674   6441631
   macro avg     0.7061    0.6922    0.5413   6441631
weighted avg     0.9863    0.9674    0.9664   6441631

Confusion Matrix:
[[6143726     803    3776]
 [  54283   62821  146278]
 [   4632     192   25120]]

------ Stage 2 with KNN (k=5) ------
Training Time: 1.95151 seconds
Accuracy: 0.9972
Precision: 0.9973
Recall: 0.9972
F1 Score: 0.9972
F2 Score: 0.9972

              precision    recall  f1-score   support

           0     0.9999    0.9969    0.9984    213678
           1     0.9745    0.9996    0.9869     25312

    accuracy                         0.9972    238990
   macro avg     0.9872    0.9982    0.9926    238990
weighted avg     0.9973    0.9972    0.9972    238990

Confusion Matrix:
[[213016    662]
 [    11  25301]]

Combined Classification Report:
Accuracy: 0.9901
Precision: 0.9901
Recall: 0.9901
F1 Score: 0.9897
F2 Score: 0.9899

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9815    0.7938    0.8777    263382
           2     0.9745    0.8449    0.9051     29944

    accuracy                         0.9901   6441631
   macro avg     0.9822    0.8793    0.9259   6441631
weighted avg     0.9901    0.9901    0.9897   6441631

Confusion Matrix:
[[6143726    3936     643]
 [  54283  209080      19]
 [   4632      11   25301]]

------ Stage 2 with Gradient Boosting ------
Training Time: 70.20510 seconds
Accuracy: 0.9974
Precision: 0.9974
Recall: 0.9974
F1 Score: 0.9974
F2 Score: 0.9974

              precision    recall  f1-score   support

           0     0.9986    0.9985    0.9986    213678
           1     0.9874    0.9885    0.9879     25312

    accuracy                         0.9974    238990
   macro avg     0.9930    0.9935    0.9932    238990
weighted avg     0.9974    0.9974    0.9974    238990

Confusion Matrix:
[[213358    320]
 [   292  25020]]

Combined Classification Report:
Accuracy: 0.9901
Precision: 0.9900
Recall: 0.9901
F1 Score: 0.9896
F2 Score: 0.9898

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9778    0.7932    0.8759    263382
           2     0.9874    0.8356    0.9051     29944

    accuracy                         0.9901   6441631
   macro avg     0.9852    0.8760    0.9253   6441631
weighted avg     0.9900    0.9901    0.9896   6441631

Confusion Matrix:
[[6143726    4448     131]
 [  54283  208910     189]
 [   4632     292   25020]]

------ Stage 2 with Logistic Regression ------
Training Time: 3.22892 seconds
Accuracy: 0.9283
Precision: 0.9242
Recall: 0.9283
F1 Score: 0.9258
F2 Score: 0.9272

              precision    recall  f1-score   support

           0     0.9521    0.9684    0.9602    213678
           1     0.6885    0.5891    0.6349     25312

    accuracy                         0.9283    238990
   macro avg     0.8203    0.7788    0.7976    238990
weighted avg     0.9242    0.9283    0.9258    238990

Confusion Matrix:
[[206931   6747]
 [ 10400  14912]]

Combined Classification Report:
Accuracy: 0.9876
Precision: 0.9868
Recall: 0.9876
F1 Score: 0.9868
F2 Score: 0.9872

              precision    recall  f1-score   support

           0     0.9905    0.9993    0.9949   6148305
           1     0.9353    0.7717    0.8457    263382
           2     0.6885    0.4980    0.5780     29944

    accuracy                         0.9876   6441631
   macro avg     0.8714    0.7563    0.8062   6441631
weighted avg     0.9868    0.9876    0.9868   6441631

Confusion Matrix:
[[6143726    3669     910]
 [  54283  203262    5837]
 [   4632   10400   14912]]

--- Stage 1 with Logistic Regression ---
Training Time: 71.24898 seconds
Accuracy: 0.9478
Precision: 0.9277
Recall: 0.9478
F1 Score: 0.9354
F2 Score: 0.9426

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2867    0.0976    0.1456    293326

    accuracy                         0.9478   6441631
   macro avg     0.6225    0.5430    0.5594   6441631
weighted avg     0.9277    0.9478    0.9354   6441631

Confusion Matrix:
[[6077071   71234]
 [ 264701   28625]]

------ Stage 2 with Decision Tree (Gini) ------
Training Time: 1.78103 seconds
Tree Depth (Stage 2): 15
Accuracy: 0.9985
Precision: 0.9988
Recall: 0.9985
F1 Score: 0.9986
F2 Score: 0.9985

              precision    recall  f1-score   support

           0     1.0000    0.9985    0.9993     99008
           1     0.8536    1.0000    0.9210       851

    accuracy                         0.9985     99859
   macro avg     0.9268    0.9993    0.9601     99859
weighted avg     0.9988    0.9985    0.9986     99859

Confusion Matrix:
[[98862   146]
 [    0   851]]

Combined Classification Report:
Accuracy: 0.9478
Precision: 0.9301
Recall: 0.9478
F1 Score: 0.9353
F2 Score: 0.9426

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2809    0.1054    0.1533    263382
           2     0.8536    0.0284    0.0550     29944

    accuracy                         0.9478   6441631
   macro avg     0.6976    0.3741    0.3938   6441631
weighted avg     0.9301    0.9478    0.9353   6441631

Confusion Matrix:
[[6077071   71089     145]
 [ 235608   27773       1]
 [  29093       0     851]]

------ Stage 2 with Random Forest (Gini) ------
Training Time: 29.88965 seconds
Random Forest Depths (Stage 2) -> Avg: 23.16, Max: 32, Min: 19
Accuracy: 0.9999
Precision: 0.9999
Recall: 0.9999
F1 Score: 0.9999
F2 Score: 0.9999

              precision    recall  f1-score   support

           0     1.0000    0.9999    0.9999     99008
           1     0.9872    1.0000    0.9936       851

    accuracy                         0.9999     99859
   macro avg     0.9936    0.9999    0.9968     99859
weighted avg     0.9999    0.9999    0.9999     99859

Confusion Matrix:
[[98997    11]
 [    0   851]]

Combined Classification Report:
Accuracy: 0.9478
Precision: 0.9307
Recall: 0.9478
F1 Score: 0.9353
F2 Score: 0.9426

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2805    0.1054    0.1533    263382
           2     0.9872    0.0284    0.0552     29944

    accuracy                         0.9478   6441631
   macro avg     0.7420    0.3741    0.3939   6441631
weighted avg     0.9307    0.9478    0.9353   6441631

Confusion Matrix:
[[6077071   71225       9]
 [ 235608   27772       2]
 [  29093       0     851]]

------ Stage 2 with Naive Bayes ------
Training Time: 0.14396 seconds
Accuracy: 0.2086
Precision: 0.9913
Recall: 0.2086
F1 Score: 0.3332
F2 Score: 0.2386

              precision    recall  f1-score   support

           0     0.9997    0.2019    0.3359     99008
           1     0.0106    0.9941    0.0210       851

    accuracy                         0.2086     99859
   macro avg     0.5052    0.5980    0.1784     99859
weighted avg     0.9913    0.2086    0.3332     99859

Confusion Matrix:
[[19987 79021]
 [    5   846]]

Combined Classification Report:
Accuracy: 0.9452
Precision: 0.9365
Recall: 0.9452
F1 Score: 0.9319
F2 Score: 0.9396

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.5345    0.0406    0.0754    263382
           2     0.0106    0.0283    0.0154     29944

    accuracy                         0.9452   6441631
   macro avg     0.5011    0.3524    0.3546   6441631
weighted avg     0.9365    0.9452    0.9319   6441631

Confusion Matrix:
[[6077071    9302   61932]
 [ 235608   10685   17089]
 [  29093       5     846]]

------ Stage 2 with KNN (k=5) ------
Training Time: 1.96004 seconds
Accuracy: 0.9560
Precision: 0.9928
Recall: 0.9560
F1 Score: 0.9714
F2 Score: 0.9602

              precision    recall  f1-score   support

           0     1.0000    0.9557    0.9773     99008
           1     0.1622    0.9988    0.2791       851

    accuracy                         0.9560     99859
   macro avg     0.5811    0.9772    0.6282     99859
weighted avg     0.9928    0.9560    0.9714     99859

Confusion Matrix:
[[94617  4391]
 [    1   850]]

Combined Classification Report:
Accuracy: 0.9478
Precision: 0.9274
Recall: 0.9478
F1 Score: 0.9354
F2 Score: 0.9426

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2934    0.1054    0.1551    263382
           2     0.1622    0.0284    0.0483     29944

    accuracy                         0.9478   6441631
   macro avg     0.4713    0.3741    0.3922   6441631
weighted avg     0.9274    0.9478    0.9354   6441631

Confusion Matrix:
[[6077071   66853    4381]
 [ 235608   27764      10]
 [  29093       1     850]]

------ Stage 2 with Gradient Boosting ------
Training Time: 70.08526 seconds
Accuracy: 0.9983
Precision: 0.9983
Recall: 0.9983
F1 Score: 0.9983
F2 Score: 0.9983

              precision    recall  f1-score   support

           0     0.9994    0.9989    0.9991     99008
           1     0.8767    0.9271    0.9012       851

    accuracy                         0.9983     99859
   macro avg     0.9380    0.9630    0.9502     99859
weighted avg     0.9983    0.9983    0.9983     99859

Confusion Matrix:
[[98897   111]
 [   62   789]]

Combined Classification Report:
Accuracy: 0.9478
Precision: 0.9301
Recall: 0.9478
F1 Score: 0.9353
F2 Score: 0.9426

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2799    0.1051    0.1529    263382
           2     0.8767    0.0263    0.0512     29944

    accuracy                         0.9478   6441631
   macro avg     0.7049    0.3733    0.3924   6441631
weighted avg     0.9301    0.9478    0.9353   6441631

Confusion Matrix:
[[6077071   71203      31]
 [ 235608   27694      80]
 [  29093      62     789]]

------ Stage 2 with Logistic Regression ------
Training Time: 3.13499 seconds
Accuracy: 0.9660
Precision: 0.9835
Recall: 0.9660
F1 Score: 0.9746
F2 Score: 0.9693

              precision    recall  f1-score   support

           0     0.9918    0.9738    0.9827     99008
           1     0.0189    0.0588    0.0286       851

    accuracy                         0.9660     99859
   macro avg     0.5053    0.5163    0.5056     99859
weighted avg     0.9835    0.9660    0.9746     99859

Confusion Matrix:
[[96412  2596]
 [  801    50]]

Combined Classification Report:
Accuracy: 0.9477
Precision: 0.9263
Recall: 0.9477
F1 Score: 0.9351
F2 Score: 0.9424

              precision    recall  f1-score   support

           0     0.9583    0.9884    0.9731   6148305
           1     0.2843    0.1049    0.1533    263382
           2     0.0189    0.0017    0.0031     29944

    accuracy                         0.9477   6441631
   macro avg     0.4205    0.3650    0.3765   6441631
weighted avg     0.9263    0.9477    0.9351   6441631

Confusion Matrix:
[[6077071   68777    2457]
 [ 235608   27635     139]
 [  29093     801      50]]

All loops completed.
